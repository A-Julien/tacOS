<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>tac0S: PostOffice Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tac0S
   </div>
   <div id="projectbrief">Template Affectional Command Operating System</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="class_post_office-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">PostOffice Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af79d08378025395d9e5fbcb62fc508cb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_post_office.html#af79d08378025395d9e5fbcb62fc508cb">PostOffice</a> (<a class="el" href="network_8h.html#a5f46a8b9223b0d95abfe3f8f39bc4e39">NetworkAddress</a> addr, double reliability, int nBoxes)</td></tr>
<tr class="memdesc:af79d08378025395d9e5fbcb62fc508cb"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_post_office.html#af79d08378025395d9e5fbcb62fc508cb" title="PostOffice::PostOffice Initialize a post office as a collection of mailboxes. Also initialize the net...">PostOffice::PostOffice</a> Initialize a post office as a collection of mailboxes. Also initialize the network device, to allow post offices on different machines to deliver messages to one another.  <a href="#af79d08378025395d9e5fbcb62fc508cb">More...</a><br /></td></tr>
<tr class="separator:af79d08378025395d9e5fbcb62fc508cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63fc4bc1a2dfd2a2a911342bfec9f2f1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a63fc4bc1a2dfd2a2a911342bfec9f2f1"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_post_office.html#a63fc4bc1a2dfd2a2a911342bfec9f2f1">~PostOffice</a> ()</td></tr>
<tr class="memdesc:a63fc4bc1a2dfd2a2a911342bfec9f2f1"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_post_office.html#a63fc4bc1a2dfd2a2a911342bfec9f2f1" title="PostOffice::~PostOffice De-allocate the post office data structures. ">PostOffice::~PostOffice</a> De-allocate the post office data structures. <br /></td></tr>
<tr class="separator:a63fc4bc1a2dfd2a2a911342bfec9f2f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06fa263f4cd816e35c8aa78c5168f21f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_post_office.html#a06fa263f4cd816e35c8aa78c5168f21f">Send</a> (<a class="el" href="class_packet_header.html">PacketHeader</a> pktHdr, <a class="el" href="class_mail_header.html">MailHeader</a> mailHdr, const char *<a class="el" href="structdata.html">data</a>)</td></tr>
<tr class="memdesc:a06fa263f4cd816e35c8aa78c5168f21f"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_post_office.html#a06fa263f4cd816e35c8aa78c5168f21f" title="PostOffice::Send Concatenate the MailHeader to the front of the data, and pass the result to the Netw...">PostOffice::Send</a> Concatenate the <a class="el" href="class_mail_header.html" title="The following class defines part of the message header. This is prepended to the message by the PostO...">MailHeader</a> to the front of the data, and pass the result to the <a class="el" href="class_network.html">Network</a> for delivery to the destination machine.  <a href="#a06fa263f4cd816e35c8aa78c5168f21f">More...</a><br /></td></tr>
<tr class="separator:a06fa263f4cd816e35c8aa78c5168f21f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a933ada80e0a7a5f360b80a26134b5f53"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_post_office.html#a933ada80e0a7a5f360b80a26134b5f53">Receive</a> (int box, <a class="el" href="class_packet_header.html">PacketHeader</a> *pktHdr, <a class="el" href="class_mail_header.html">MailHeader</a> *mailHdr, char *<a class="el" href="structdata.html">data</a>)</td></tr>
<tr class="memdesc:a933ada80e0a7a5f360b80a26134b5f53"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_post_office.html#a06fa263f4cd816e35c8aa78c5168f21f" title="PostOffice::Send Concatenate the MailHeader to the front of the data, and pass the result to the Netw...">PostOffice::Send</a> Retrieve a message from a specific box if one is available, otherwise wait for a message to arrive in the box.  <a href="#a933ada80e0a7a5f360b80a26134b5f53">More...</a><br /></td></tr>
<tr class="separator:a933ada80e0a7a5f360b80a26134b5f53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67ca2cc25e411b1e83580728d8fcfea8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_post_office.html#a67ca2cc25e411b1e83580728d8fcfea8">PostalDelivery</a> ()</td></tr>
<tr class="memdesc:a67ca2cc25e411b1e83580728d8fcfea8"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_post_office.html#a67ca2cc25e411b1e83580728d8fcfea8" title="PostOffice::PostalDelivery Wait for incoming messages, and put them in the right mailbox. ">PostOffice::PostalDelivery</a> Wait for incoming messages, and put them in the right mailbox.  <a href="#a67ca2cc25e411b1e83580728d8fcfea8">More...</a><br /></td></tr>
<tr class="separator:a67ca2cc25e411b1e83580728d8fcfea8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab32fd95c48b517b274f4e20bf16e775"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_post_office.html#aab32fd95c48b517b274f4e20bf16e775">PacketSent</a> ()</td></tr>
<tr class="memdesc:aab32fd95c48b517b274f4e20bf16e775"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_post_office.html#aab32fd95c48b517b274f4e20bf16e775" title="PostOffice::PacketSent Interrupt handler, called when the next packet can be put onto the network...">PostOffice::PacketSent</a> <a class="el" href="class_interrupt.html">Interrupt</a> handler, called when the next packet can be put onto the network.  <a href="#aab32fd95c48b517b274f4e20bf16e775">More...</a><br /></td></tr>
<tr class="separator:aab32fd95c48b517b274f4e20bf16e775"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f1c8896b71f3ef617e106baf1d08e59"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_post_office.html#a4f1c8896b71f3ef617e106baf1d08e59">IncomingPacket</a> ()</td></tr>
<tr class="memdesc:a4f1c8896b71f3ef617e106baf1d08e59"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_post_office.html#a4f1c8896b71f3ef617e106baf1d08e59" title="PostOffice::IncomingPacket Interrupt handler, called when a packet arrives from the network...">PostOffice::IncomingPacket</a> <a class="el" href="class_interrupt.html">Interrupt</a> handler, called when a packet arrives from the network.  <a href="#a4f1c8896b71f3ef617e106baf1d08e59">More...</a><br /></td></tr>
<tr class="separator:a4f1c8896b71f3ef617e106baf1d08e59"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="af79d08378025395d9e5fbcb62fc508cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PostOffice::PostOffice </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="network_8h.html#a5f46a8b9223b0d95abfe3f8f39bc4e39">NetworkAddress</a>&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>reliability</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nBoxes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="class_post_office.html#af79d08378025395d9e5fbcb62fc508cb" title="PostOffice::PostOffice Initialize a post office as a collection of mailboxes. Also initialize the net...">PostOffice::PostOffice</a> Initialize a post office as a collection of mailboxes. Also initialize the network device, to allow post offices on different machines to deliver messages to one another. </p>
<p>We use a separate thread "the postal worker" to wait for messages to arrive, and deliver them to the correct mailbox. Note that delivering messages to the mailboxes can't be done directly by the interrupt handlers, because it requires a <a class="el" href="class_lock.html">Lock</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">addr</td><td>is this machine's network ID </td></tr>
    <tr><td class="paramname">reliability</td><td>is the probability that a network packet will be delivered (e.g., reliability = 1 means the network never drops any packets; reliability = 0 means the network never delivers any packets) </td></tr>
    <tr><td class="paramname">nBoxes</td><td>is the number of mail boxes in this Post Office </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a4f1c8896b71f3ef617e106baf1d08e59"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PostOffice::IncomingPacket </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="class_post_office.html#a4f1c8896b71f3ef617e106baf1d08e59" title="PostOffice::IncomingPacket Interrupt handler, called when a packet arrives from the network...">PostOffice::IncomingPacket</a> <a class="el" href="class_interrupt.html">Interrupt</a> handler, called when a packet arrives from the network. </p>
<p>Signal the PostalDelivery routine that it is time to get to work! </p>

</div>
</div>
<a class="anchor" id="aab32fd95c48b517b274f4e20bf16e775"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PostOffice::PacketSent </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="class_post_office.html#aab32fd95c48b517b274f4e20bf16e775" title="PostOffice::PacketSent Interrupt handler, called when the next packet can be put onto the network...">PostOffice::PacketSent</a> <a class="el" href="class_interrupt.html">Interrupt</a> handler, called when the next packet can be put onto the network. </p>
<p>The name of this routine is a misnomer; if "reliability &lt; 1", the packet could have been dropped by the network, so it won't get through. </p>

</div>
</div>
<a class="anchor" id="a67ca2cc25e411b1e83580728d8fcfea8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PostOffice::PostalDelivery </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="class_post_office.html#a67ca2cc25e411b1e83580728d8fcfea8" title="PostOffice::PostalDelivery Wait for incoming messages, and put them in the right mailbox. ">PostOffice::PostalDelivery</a> Wait for incoming messages, and put them in the right mailbox. </p>
<p>Incoming messages have had the <a class="el" href="class_packet_header.html" title="The following class defines the network packet header. The packet header is prepended to the data pay...">PacketHeader</a> stripped off, but the <a class="el" href="class_mail_header.html" title="The following class defines part of the message header. This is prepended to the message by the PostO...">MailHeader</a> is still tacked on the front of the data. </p>

</div>
</div>
<a class="anchor" id="a933ada80e0a7a5f360b80a26134b5f53"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PostOffice::Receive </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>box</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_packet_header.html">PacketHeader</a> *&#160;</td>
          <td class="paramname"><em>pktHdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_mail_header.html">MailHeader</a> *&#160;</td>
          <td class="paramname"><em>mailHdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="class_post_office.html#a06fa263f4cd816e35c8aa78c5168f21f" title="PostOffice::Send Concatenate the MailHeader to the front of the data, and pass the result to the Netw...">PostOffice::Send</a> Retrieve a message from a specific box if one is available, otherwise wait for a message to arrive in the box. </p>
<p>Note that the <a class="el" href="class_mail_header.html" title="The following class defines part of the message header. This is prepended to the message by the PostO...">MailHeader</a> + data looks just like normal payload data to the <a class="el" href="class_network.html">Network</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">box</td><td>&ndash; mailbox ID in which to look for message </td></tr>
    <tr><td class="paramname">pktHdr</td><td>&ndash; address to put: source, destination machine ID's </td></tr>
    <tr><td class="paramname">mailHdr</td><td>&ndash; address to put: source, destination mailbox ID's </td></tr>
    <tr><td class="paramname">data</td><td>&ndash; address to put: payload message data </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a06fa263f4cd816e35c8aa78c5168f21f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PostOffice::Send </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_packet_header.html">PacketHeader</a>&#160;</td>
          <td class="paramname"><em>pktHdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_mail_header.html">MailHeader</a>&#160;</td>
          <td class="paramname"><em>mailHdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="class_post_office.html#a06fa263f4cd816e35c8aa78c5168f21f" title="PostOffice::Send Concatenate the MailHeader to the front of the data, and pass the result to the Netw...">PostOffice::Send</a> Concatenate the <a class="el" href="class_mail_header.html" title="The following class defines part of the message header. This is prepended to the message by the PostO...">MailHeader</a> to the front of the data, and pass the result to the <a class="el" href="class_network.html">Network</a> for delivery to the destination machine. </p>
<p>Note that the <a class="el" href="class_mail_header.html" title="The following class defines part of the message header. This is prepended to the message by the PostO...">MailHeader</a> + data looks just like normal payload data to the <a class="el" href="class_network.html">Network</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pktHdr</td><td>&ndash; source, destination machine ID's </td></tr>
    <tr><td class="paramname">mailHdr</td><td>&ndash; source, destination mailbox ID's </td></tr>
    <tr><td class="paramname">data</td><td>&ndash; payload message data </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>code/network/<a class="el" href="post_8h_source.html">post.h</a></li>
<li>code/network/<a class="el" href="post_8cc.html">post.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
