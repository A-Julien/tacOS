<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>tac0S: OpenFile Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tac0S
   </div>
   <div id="projectbrief">Template Affectional Command Operating System</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="class_open_file-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">OpenFile Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a89136ac6b54013a413398f9496d39963"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_open_file.html#a89136ac6b54013a413398f9496d39963">OpenFile</a> (int sector)</td></tr>
<tr class="memdesc:a89136ac6b54013a413398f9496d39963"><td class="mdescLeft">&#160;</td><td class="mdescRight">OpenFileTable::OpenFileTable Open a Nachos file for reading and writing. Bring the file header into memory while the file is open.  <a href="#a89136ac6b54013a413398f9496d39963">More...</a><br /></td></tr>
<tr class="separator:a89136ac6b54013a413398f9496d39963"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d59e2d0a4e8eb5f21f31f7179dd6e50"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1d59e2d0a4e8eb5f21f31f7179dd6e50"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_open_file.html#a1d59e2d0a4e8eb5f21f31f7179dd6e50">~OpenFile</a> ()</td></tr>
<tr class="memdesc:a1d59e2d0a4e8eb5f21f31f7179dd6e50"><td class="mdescLeft">&#160;</td><td class="mdescRight">OpenFileTable::~OpenFileTable Close a Nachos file, de-allocating any in-memory data structures. <br /></td></tr>
<tr class="separator:a1d59e2d0a4e8eb5f21f31f7179dd6e50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a433b973064ddc166d16ba6db7070c689"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_open_file.html#a433b973064ddc166d16ba6db7070c689">Seek</a> (int position, unsigned int tid=0)</td></tr>
<tr class="memdesc:a433b973064ddc166d16ba6db7070c689"><td class="mdescLeft">&#160;</td><td class="mdescRight">OpenFileTable::Seek Change the current location within the open file &ndash; the point at which the next Read or Write will start from.  <a href="#a433b973064ddc166d16ba6db7070c689">More...</a><br /></td></tr>
<tr class="separator:a433b973064ddc166d16ba6db7070c689"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64c12d6083255a817bf0c26b44ad1d84"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_open_file.html#a64c12d6083255a817bf0c26b44ad1d84">Read</a> (char *into, int numBytes, unsigned int tid=0)</td></tr>
<tr class="memdesc:a64c12d6083255a817bf0c26b44ad1d84"><td class="mdescLeft">&#160;</td><td class="mdescRight">OpenFileTable::Read/Write Read/write a portion of a file, starting from seekPosition.  <a href="#a64c12d6083255a817bf0c26b44ad1d84">More...</a><br /></td></tr>
<tr class="separator:a64c12d6083255a817bf0c26b44ad1d84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cfcc702b31678946f7bb4c6ce790adf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_open_file.html#a0cfcc702b31678946f7bb4c6ce790adf">Write</a> (const char *from, int numBytes, unsigned int tid=0)</td></tr>
<tr class="memdesc:a0cfcc702b31678946f7bb4c6ce790adf"><td class="mdescLeft">&#160;</td><td class="mdescRight">OpenFileTable::Write into a file.  <a href="#a0cfcc702b31678946f7bb4c6ce790adf">More...</a><br /></td></tr>
<tr class="separator:a0cfcc702b31678946f7bb4c6ce790adf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0af8cd52ec71a2ad407039cebee2ef3d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_open_file.html#a0af8cd52ec71a2ad407039cebee2ef3d">ReadAt</a> (char *into, int numBytes, int position)</td></tr>
<tr class="memdesc:a0af8cd52ec71a2ad407039cebee2ef3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">OpenFileTable::ReadAt/WriteAt Read/write a portion of a file, starting at "position". Return the number of bytes actually written or read, but has no side effects (except that Write modifies the file, of course).  <a href="#a0af8cd52ec71a2ad407039cebee2ef3d">More...</a><br /></td></tr>
<tr class="separator:a0af8cd52ec71a2ad407039cebee2ef3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdafc019e4fa166c44e8f7d4f820166f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afdafc019e4fa166c44e8f7d4f820166f"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>WriteAt</b> (const char *from, int numBytes, int position)</td></tr>
<tr class="separator:afdafc019e4fa166c44e8f7d4f820166f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d5618da2388829f294c3f33017fadac"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_open_file.html#a5d5618da2388829f294c3f33017fadac">Length</a> ()</td></tr>
<tr class="memdesc:a5d5618da2388829f294c3f33017fadac"><td class="mdescLeft">&#160;</td><td class="mdescRight">OpenFileTable::Length.  <a href="#a5d5618da2388829f294c3f33017fadac">More...</a><br /></td></tr>
<tr class="separator:a5d5618da2388829f294c3f33017fadac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e81afbe1bdb4de7139201abe79fe6b6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1e81afbe1bdb4de7139201abe79fe6b6"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>get_sector</b> ()</td></tr>
<tr class="separator:a1e81afbe1bdb4de7139201abe79fe6b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f4361f0d8db3c827029d63ce1d65453"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_open_file.html#a4f4361f0d8db3c827029d63ce1d65453">add_seek</a> (unsigned int tid)</td></tr>
<tr class="memdesc:a4f4361f0d8db3c827029d63ce1d65453"><td class="mdescLeft">&#160;</td><td class="mdescRight">OpenFileTable::add_seek add a seek to a openfile Allow multi threads to access to the same openfile with separated pointer.  <a href="#a4f4361f0d8db3c827029d63ce1d65453">More...</a><br /></td></tr>
<tr class="separator:a4f4361f0d8db3c827029d63ce1d65453"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4e52e87d66083494a5a241fbec63daf"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_open_file.html#ae4e52e87d66083494a5a241fbec63daf">remove_seek</a> (unsigned int tid)</td></tr>
<tr class="memdesc:ae4e52e87d66083494a5a241fbec63daf"><td class="mdescLeft">&#160;</td><td class="mdescRight">OpenFileTable::remove_seek remove a seek to a openfile Allow multi threads to access to the same openfile with separated pointer.  <a href="#ae4e52e87d66083494a5a241fbec63daf">More...</a><br /></td></tr>
<tr class="separator:ae4e52e87d66083494a5a241fbec63daf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac612d4d27fe45282798add721abc4c49"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac612d4d27fe45282798add721abc4c49"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>isOpenByOthers</b> ()</td></tr>
<tr class="separator:ac612d4d27fe45282798add721abc4c49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7f725818633b66a62357ffe75d82712"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad7f725818633b66a62357ffe75d82712"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>isdir</b> ()</td></tr>
<tr class="separator:ad7f725818633b66a62357ffe75d82712"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a89136ac6b54013a413398f9496d39963"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OpenFile::OpenFile </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sector</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>OpenFileTable::OpenFileTable Open a Nachos file for reading and writing. Bring the file header into memory while the file is open. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sector</td><td>&ndash; the location on disk of the file header for this file </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a4f4361f0d8db3c827029d63ce1d65453"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void OpenFile::add_seek </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>tid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>OpenFileTable::add_seek add a seek to a openfile Allow multi threads to access to the same openfile with separated pointer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tid</td><td>the thread tid </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a5d5618da2388829f294c3f33017fadac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int OpenFile::Length </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>OpenFileTable::Length. </p>
<dl class="section return"><dt>Returns</dt><dd>Return the number of bytes in the file. </dd></dl>

</div>
</div>
<a class="anchor" id="a64c12d6083255a817bf0c26b44ad1d84"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int OpenFile::Read </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>into</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numBytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>tid</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>OpenFileTable::Read/Write Read/write a portion of a file, starting from seekPosition. </p>
<dl class="section return"><dt>Returns</dt><dd>Return the number of bytes actually written or read, and as a side effect, increment the current position within the file.</dd></dl>
<p>Implemented using the more primitive ReadAt/WriteAt.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">into</td><td>&ndash; the buffer to contain the data to be read from disk </td></tr>
    <tr><td class="paramname">from</td><td>&ndash; the buffer containing the data to be written to disk </td></tr>
    <tr><td class="paramname">numBytes</td><td>&ndash; the number of bytes to transfer </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a0af8cd52ec71a2ad407039cebee2ef3d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int OpenFile::ReadAt </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>into</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numBytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>position</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>OpenFileTable::ReadAt/WriteAt Read/write a portion of a file, starting at "position". Return the number of bytes actually written or read, but has no side effects (except that Write modifies the file, of course). </p>
<p>There is no guarantee the request starts or ends on an even disk sector boundary; however the disk only knows how to read/write a whole disk sector at a time. Thus:</p>
<p>For ReadAt: We read in all of the full or partial sectors that are part of the request, but we only copy the part we are interested in. For WriteAt: We must first read in any sectors that will be partially written, so that we don't overwrite the unmodified portion. We then copy in the data that will be modified, and write back all the full or partial sectors that are part of the request.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">into</td><td>&ndash; the buffer to contain the data to be read from disk </td></tr>
    <tr><td class="paramname">from</td><td>&ndash; the buffer containing the data to be written to disk </td></tr>
    <tr><td class="paramname">numBytes</td><td>&ndash; the number of bytes to transfer </td></tr>
    <tr><td class="paramname">position</td><td>&ndash; the offset within the file of the first byte to be read/written </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae4e52e87d66083494a5a241fbec63daf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool OpenFile::remove_seek </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>tid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>OpenFileTable::remove_seek remove a seek to a openfile Allow multi threads to access to the same openfile with separated pointer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tid</td><td>the thread tid </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a433b973064ddc166d16ba6db7070c689"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void OpenFile::Seek </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>tid</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>OpenFileTable::Seek Change the current location within the open file &ndash; the point at which the next Read or Write will start from. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">position</td><td>&ndash; the location within the file for the next Read/Write </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a0cfcc702b31678946f7bb4c6ce790adf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int OpenFile::Write </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>into</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numBytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>tid</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>OpenFileTable::Write into a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">into</td><td></td></tr>
    <tr><td class="paramname">numBytes</td><td></td></tr>
    <tr><td class="paramname">tid</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>code/filesys/<a class="el" href="openfile_8h_source.html">openfile.h</a></li>
<li>code/filesys/openfile.cc</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
