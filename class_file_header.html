<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>tac0S: FileHeader Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tac0S
   </div>
   <div id="projectbrief">Template Affectional Command Operating System</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="class_file_header-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">FileHeader Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The following class defines the Nachos "file header" (in UNIX terms, the "i-node"), describing where on disk to find all of the data in the file. The file header is organized as a simple table of pointers to data blocks.  
 <a href="class_file_header.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="filehdr_8h_source.html">filehdr.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a2fb90f63470e10c847393e124763fd1a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_file_header.html#a2fb90f63470e10c847393e124763fd1a">Allocate</a> (<a class="el" href="class_bit_map.html">BitMap</a> *bitMap, int fileSize)</td></tr>
<tr class="memdesc:a2fb90f63470e10c847393e124763fd1a"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_file_header.html#a2fb90f63470e10c847393e124763fd1a" title="FileHeader::Allocate Initialize a fresh file header for a newly created file. Allocate data blocks fo...">FileHeader::Allocate</a> Initialize a fresh file header for a newly created file. Allocate data blocks for the file out of the map of free disk blocks.  <a href="#a2fb90f63470e10c847393e124763fd1a">More...</a><br /></td></tr>
<tr class="separator:a2fb90f63470e10c847393e124763fd1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d8a66db0af2460ccb27edd8d2331179"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_file_header.html#a0d8a66db0af2460ccb27edd8d2331179">Deallocate</a> (<a class="el" href="class_bit_map.html">BitMap</a> *bitMap)</td></tr>
<tr class="memdesc:a0d8a66db0af2460ccb27edd8d2331179"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_file_header.html#a0d8a66db0af2460ccb27edd8d2331179" title="FileHeader::Deallocate De-allocate all the space allocated for data blocks for this file...">FileHeader::Deallocate</a> De-allocate all the space allocated for data blocks for this file.  <a href="#a0d8a66db0af2460ccb27edd8d2331179">More...</a><br /></td></tr>
<tr class="separator:a0d8a66db0af2460ccb27edd8d2331179"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa85564cee98fc9592df08cc5e4a2efc6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_file_header.html#aa85564cee98fc9592df08cc5e4a2efc6">FetchFrom</a> (int sectorNumber)</td></tr>
<tr class="memdesc:aa85564cee98fc9592df08cc5e4a2efc6"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_file_header.html#aa85564cee98fc9592df08cc5e4a2efc6" title="FileHeader::FetchFrom Fetch contents of file header from disk. ">FileHeader::FetchFrom</a> Fetch contents of file header from disk.  <a href="#aa85564cee98fc9592df08cc5e4a2efc6">More...</a><br /></td></tr>
<tr class="separator:aa85564cee98fc9592df08cc5e4a2efc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab896cc7dd7274e3f8072da2c7d9beee8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_file_header.html#ab896cc7dd7274e3f8072da2c7d9beee8">WriteBack</a> (int sectorNumber)</td></tr>
<tr class="memdesc:ab896cc7dd7274e3f8072da2c7d9beee8"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_file_header.html#ab896cc7dd7274e3f8072da2c7d9beee8" title="FileHeader::WriteBack Write the modified contents of the file header back to disk. ">FileHeader::WriteBack</a> Write the modified contents of the file header back to disk.  <a href="#ab896cc7dd7274e3f8072da2c7d9beee8">More...</a><br /></td></tr>
<tr class="separator:ab896cc7dd7274e3f8072da2c7d9beee8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adacbe1c1af441d0b1e978c65a05d60f2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_file_header.html#adacbe1c1af441d0b1e978c65a05d60f2">ByteToSector</a> (int offset)</td></tr>
<tr class="memdesc:adacbe1c1af441d0b1e978c65a05d60f2"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_file_header.html#adacbe1c1af441d0b1e978c65a05d60f2" title="FileHeader::ByteToSector. ">FileHeader::ByteToSector</a>.  <a href="#adacbe1c1af441d0b1e978c65a05d60f2">More...</a><br /></td></tr>
<tr class="separator:adacbe1c1af441d0b1e978c65a05d60f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a676d88bbc37d3d108625be75d637a8e6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_file_header.html#a676d88bbc37d3d108625be75d637a8e6">FileLength</a> ()</td></tr>
<tr class="memdesc:a676d88bbc37d3d108625be75d637a8e6"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_file_header.html#a676d88bbc37d3d108625be75d637a8e6" title="FileHeader::FileLength. ">FileHeader::FileLength</a>.  <a href="#a676d88bbc37d3d108625be75d637a8e6">More...</a><br /></td></tr>
<tr class="separator:a676d88bbc37d3d108625be75d637a8e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57b661cda2c4d51ee06cc29e7ea0a0c0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a57b661cda2c4d51ee06cc29e7ea0a0c0"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_file_header.html#a57b661cda2c4d51ee06cc29e7ea0a0c0">Print</a> ()</td></tr>
<tr class="memdesc:a57b661cda2c4d51ee06cc29e7ea0a0c0"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_file_header.html#a57b661cda2c4d51ee06cc29e7ea0a0c0" title="FileHeader::Print Print the contents of the file header, and the contents of all the data blocks poin...">FileHeader::Print</a> Print the contents of the file header, and the contents of all the data blocks pointed to by the file header. <br /></td></tr>
<tr class="separator:a57b661cda2c4d51ee06cc29e7ea0a0c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93e3ba0cc839c78b5606259588e4d914"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a93e3ba0cc839c78b5606259588e4d914"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>test</b> ()</td></tr>
<tr class="separator:a93e3ba0cc839c78b5606259588e4d914"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba42bd2ccffb2068ce29a3de7f9095ba"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aba42bd2ccffb2068ce29a3de7f9095ba"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>get_sector</b> (int id_sector)</td></tr>
<tr class="separator:aba42bd2ccffb2068ce29a3de7f9095ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af67d61a38d98d6f0d9b02e2f9afb7e2f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af67d61a38d98d6f0d9b02e2f9afb7e2f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_sector</b> (int id_sector, int sector)</td></tr>
<tr class="separator:af67d61a38d98d6f0d9b02e2f9afb7e2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a6de73f45247932b640a2a2028afaf787"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6de73f45247932b640a2a2028afaf787"></a>
<a class="el" href="filehdr_8h.html#a432e9e0e3cb9b5b6f20a9df00ab4a473">File_type</a>&#160;</td><td class="memItemRight" valign="bottom"><b>type</b></td></tr>
<tr class="separator:a6de73f45247932b640a2a2028afaf787"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The following class defines the Nachos "file header" (in UNIX terms, the "i-node"), describing where on disk to find all of the data in the file. The file header is organized as a simple table of pointers to data blocks. </p>
<p>The file header data structure can be stored in memory or on disk. When it is on disk, it is stored in a single sector &ndash; this means that we assume the size of this data structure to be the same as one disk sector. Without indirect addressing, this limits the maximum file length to just under 4K bytes.</p>
<p>There is no constructor; rather the file header can be initialized by allocating blocks for the file (if it is a new file), or by reading it from disk. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a2fb90f63470e10c847393e124763fd1a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool FileHeader::Allocate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bit_map.html">BitMap</a> *&#160;</td>
          <td class="paramname"><em>freeMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fileSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="class_file_header.html#a2fb90f63470e10c847393e124763fd1a" title="FileHeader::Allocate Initialize a fresh file header for a newly created file. Allocate data blocks fo...">FileHeader::Allocate</a> Initialize a fresh file header for a newly created file. Allocate data blocks for the file out of the map of free disk blocks. </p>
<dl class="section return"><dt>Returns</dt><dd>Return FALSE if there are not enough free blocks to accomodate the new file.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">freeMap</td><td>is the bit map of free disk sectors </td></tr>
    <tr><td class="paramname">fileSize</td><td>is the bit map of free disk sectors </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="adacbe1c1af441d0b1e978c65a05d60f2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int FileHeader::ByteToSector </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>offset</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="class_file_header.html#adacbe1c1af441d0b1e978c65a05d60f2" title="FileHeader::ByteToSector. ">FileHeader::ByteToSector</a>. </p>
<dl class="section return"><dt>Returns</dt><dd>Return which disk sector is storing a particular byte within the file. This is essentially a translation from a virtual address (the offset in the file) to a physical address (the sector where the data at the offset is stored).</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">offset</td><td>is the location within the file of the byte in question </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a0d8a66db0af2460ccb27edd8d2331179"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FileHeader::Deallocate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bit_map.html">BitMap</a> *&#160;</td>
          <td class="paramname"><em>freeMap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="class_file_header.html#a0d8a66db0af2460ccb27edd8d2331179" title="FileHeader::Deallocate De-allocate all the space allocated for data blocks for this file...">FileHeader::Deallocate</a> De-allocate all the space allocated for data blocks for this file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">freeMap</td><td>is the bit map of free disk sectors </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa85564cee98fc9592df08cc5e4a2efc6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FileHeader::FetchFrom </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sector</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="class_file_header.html#aa85564cee98fc9592df08cc5e4a2efc6" title="FileHeader::FetchFrom Fetch contents of file header from disk. ">FileHeader::FetchFrom</a> Fetch contents of file header from disk. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sector</td><td>is the disk sector containing the file header </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a676d88bbc37d3d108625be75d637a8e6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int FileHeader::FileLength </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="class_file_header.html#a676d88bbc37d3d108625be75d637a8e6" title="FileHeader::FileLength. ">FileHeader::FileLength</a>. </p>
<dl class="section return"><dt>Returns</dt><dd>Return the number of bytes in the file. </dd></dl>

</div>
</div>
<a class="anchor" id="ab896cc7dd7274e3f8072da2c7d9beee8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FileHeader::WriteBack </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sector</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="class_file_header.html#ab896cc7dd7274e3f8072da2c7d9beee8" title="FileHeader::WriteBack Write the modified contents of the file header back to disk. ">FileHeader::WriteBack</a> Write the modified contents of the file header back to disk. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sector</td><td>is the disk sector to contain the file header </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>code/filesys/<a class="el" href="filehdr_8h_source.html">filehdr.h</a></li>
<li>code/filesys/<a class="el" href="filehdr_8cc.html">filehdr.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
