<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>tac0S: code/machine/machine.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tac0S
   </div>
   <div id="projectbrief">Template Affectional Command Operating System</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_050edd66366d13764f98250ef6db77f6.html">code</a></li><li class="navelem"><a class="el" href="dir_c6faf5bb1a362c64e2b4a502a2d69864.html">machine</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">machine.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Data structures for simulating the execution of user programs running on top of Nachos.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;copyright.h&quot;</code><br />
<code>#include &quot;<a class="el" href="utility_8h_source.html">utility.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="translate_8h_source.html">translate.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="disk_8h_source.html">disk.h</a>&quot;</code><br />
</div>
<p><a href="machine_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_instruction.html">Instruction</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The following class defines an instruction, represented in both undecoded binary form decoded to identify operation to do registers to act on any immediate operand value.  <a href="class_instruction.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_machine.html">Machine</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The following class defines the simulated host workstation hardware, as seen by user programs &ndash; the CPU registers, main memory, etc. User programs shouldn't be able to tell that they are running on our simulator or on the real hardware, except we don't support floating point instructions the system call interface to Nachos is not the same as UNIX (10 system calls in Nachos vs. 200 in UNIX!) If we were to implement more of the UNIX system calls, we ought to be able to run Nachos on top of Nachos!  <a href="class_machine.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a25fe6c9816d1f84cecd50a0503825bf2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a25fe6c9816d1f84cecd50a0503825bf2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>PageSize</b>&#160;&#160;&#160;SectorSize</td></tr>
<tr class="separator:a25fe6c9816d1f84cecd50a0503825bf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b9f33667767389c6dbb4a83017ce7ed"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0b9f33667767389c6dbb4a83017ce7ed"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>NumPhysPages</b>&#160;&#160;&#160;32</td></tr>
<tr class="separator:a0b9f33667767389c6dbb4a83017ce7ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1eabbc583c21d48596127b19d4ce754"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab1eabbc583c21d48596127b19d4ce754"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MemorySize</b>&#160;&#160;&#160;(NumPhysPages * PageSize)</td></tr>
<tr class="separator:ab1eabbc583c21d48596127b19d4ce754"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af372ca9ab0550891f1b5fd24ecffbbf6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af372ca9ab0550891f1b5fd24ecffbbf6"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TLBSize</b>&#160;&#160;&#160;4</td></tr>
<tr class="separator:af372ca9ab0550891f1b5fd24ecffbbf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6702d1d5ad2fe3c3e40d9eedaaa2630f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6702d1d5ad2fe3c3e40d9eedaaa2630f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>StackReg</b>&#160;&#160;&#160;29</td></tr>
<tr class="separator:a6702d1d5ad2fe3c3e40d9eedaaa2630f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd61f2aedbb34ee6301a795667234d56"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afd61f2aedbb34ee6301a795667234d56"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RetAddrReg</b>&#160;&#160;&#160;31</td></tr>
<tr class="separator:afd61f2aedbb34ee6301a795667234d56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89f6b3d90852476c519744e6c0fdc5ff"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a89f6b3d90852476c519744e6c0fdc5ff"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>NumGPRegs</b>&#160;&#160;&#160;32</td></tr>
<tr class="separator:a89f6b3d90852476c519744e6c0fdc5ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ac19b064328f966d7cca64f3282ae91"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1ac19b064328f966d7cca64f3282ae91"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>HiReg</b>&#160;&#160;&#160;32</td></tr>
<tr class="separator:a1ac19b064328f966d7cca64f3282ae91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afef46928a742121ce69b65dad1fb625a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afef46928a742121ce69b65dad1fb625a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>LoReg</b>&#160;&#160;&#160;33</td></tr>
<tr class="separator:afef46928a742121ce69b65dad1fb625a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7152c26c857a03695afc8c8b05f1197b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7152c26c857a03695afc8c8b05f1197b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>PCReg</b>&#160;&#160;&#160;34</td></tr>
<tr class="separator:a7152c26c857a03695afc8c8b05f1197b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af95022bd1d0769baabadf6f1b771501a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af95022bd1d0769baabadf6f1b771501a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>NextPCReg</b>&#160;&#160;&#160;35</td></tr>
<tr class="separator:af95022bd1d0769baabadf6f1b771501a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa24552328a05615e6067ce5a0ad0bbf3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa24552328a05615e6067ce5a0ad0bbf3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>PrevPCReg</b>&#160;&#160;&#160;36</td></tr>
<tr class="separator:aa24552328a05615e6067ce5a0ad0bbf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ca86ddc51a5c44e599365ebce68b967"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7ca86ddc51a5c44e599365ebce68b967"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>LoadReg</b>&#160;&#160;&#160;37</td></tr>
<tr class="separator:a7ca86ddc51a5c44e599365ebce68b967"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56dbce970aafbc98848593b4d4aa5eb7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a56dbce970aafbc98848593b4d4aa5eb7"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>LoadValueReg</b>&#160;&#160;&#160;38</td></tr>
<tr class="separator:a56dbce970aafbc98848593b4d4aa5eb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aceca7cc1b20f6970f96688c4f21efef2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aceca7cc1b20f6970f96688c4f21efef2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>BadVAddrReg</b>&#160;&#160;&#160;39</td></tr>
<tr class="separator:aceca7cc1b20f6970f96688c4f21efef2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d05ab2fa1bfa8eb176488fe4119a464"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3d05ab2fa1bfa8eb176488fe4119a464"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>NumTotalRegs</b>&#160;&#160;&#160;40</td></tr>
<tr class="separator:a3d05ab2fa1bfa8eb176488fe4119a464"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a0e0f0f1661d7aeb71ed9698bff6c6383"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0e0f0f1661d7aeb71ed9698bff6c6383"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><b>ExceptionType</b> { <br />
&#160;&#160;<b>NoException</b>, 
<b>SyscallException</b>, 
<b>PageFaultException</b>, 
<b>ReadOnlyException</b>, 
<br />
&#160;&#160;<b>BusErrorException</b>, 
<b>AddressErrorException</b>, 
<b>OverflowException</b>, 
<b>IllegalInstrException</b>, 
<br />
&#160;&#160;<b>NumExceptionTypes</b>, 
<b>CharInsteadOfInt</b>, 
<b>IntOutOfBounds</b>
<br />
 }</td></tr>
<tr class="separator:a0e0f0f1661d7aeb71ed9698bff6c6383"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a69c8c3bb4a492eeea6b21600a76cada7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="machine_8h.html#a69c8c3bb4a492eeea6b21600a76cada7">ExceptionHandler</a> (ExceptionType which)</td></tr>
<tr class="memdesc:a69c8c3bb4a492eeea6b21600a76cada7"><td class="mdescLeft">&#160;</td><td class="mdescRight">ExceptionHandler Entry point into the Nachos kernel. Called when a user program is executing, and either does a syscall, or generates an addressing or arithmetic exception.  <a href="#a69c8c3bb4a492eeea6b21600a76cada7">More...</a><br /></td></tr>
<tr class="separator:a69c8c3bb4a492eeea6b21600a76cada7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56dec7a0503b1fdfa1cc4e7ac3280b58"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a56dec7a0503b1fdfa1cc4e7ac3280b58"></a>
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="machine_8h.html#a56dec7a0503b1fdfa1cc4e7ac3280b58">WordToHost</a> (unsigned int word)</td></tr>
<tr class="memdesc:a56dec7a0503b1fdfa1cc4e7ac3280b58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Routines for converting Words and Short Words to and from the simulated machine's format of little endian. These end up being NOPs when the host machine is also little endian (DEC and Intel). <br /></td></tr>
<tr class="separator:a56dec7a0503b1fdfa1cc4e7ac3280b58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7add372ad7bd2247052cf523c58a7c85"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7add372ad7bd2247052cf523c58a7c85"></a>
unsigned short&#160;</td><td class="memItemRight" valign="bottom"><b>ShortToHost</b> (unsigned short shortword)</td></tr>
<tr class="separator:a7add372ad7bd2247052cf523c58a7c85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a5c3b2db60b0034c1601f45967d5d01"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2a5c3b2db60b0034c1601f45967d5d01"></a>
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><b>WordToMachine</b> (unsigned int word)</td></tr>
<tr class="separator:a2a5c3b2db60b0034c1601f45967d5d01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3beb444ee6888212649bc77de594510"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa3beb444ee6888212649bc77de594510"></a>
unsigned short&#160;</td><td class="memItemRight" valign="bottom"><b>ShortToMachine</b> (unsigned short shortword)</td></tr>
<tr class="separator:aa3beb444ee6888212649bc77de594510"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Data structures for simulating the execution of user programs running on top of Nachos. </p>
<dl class="section author"><dt>Author</dt><dd>Olivier Hureau, Hugo Feydel , Julien ALaimo User programs are loaded into "mainMemory"; to Nachos, this looks just like an array of bytes. Of course, the Nachos kernel is in memory too &ndash; but as in most machines these days, the kernel is loaded into a separate memory region from user programs, and accesses to kernel memory are not translated or paged.</dd></dl>
<p>In Nachos, user programs are executed one instruction at a time, by the simulator. Each memory reference is translated, checked for errors, etc.</p>
<p>DO NOT CHANGE &ndash; part of the machine emulation</p>
<p>Copyright (c) 1992-1993 The Regents of the University of California. All rights reserved. See <a class="el" href="copyright_8h_source.html">copyright.h</a> for copyright notice and limitation of liability and disclaimer of warranty provisions. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a69c8c3bb4a492eeea6b21600a76cada7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ExceptionHandler </td>
          <td>(</td>
          <td class="paramtype">ExceptionType&#160;</td>
          <td class="paramname"><em>which</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ExceptionHandler Entry point into the Nachos kernel. Called when a user program is executing, and either does a syscall, or generates an addressing or arithmetic exception. </p>
<p>For system calls, the following is the calling convention:</p>
<p>system call code &ndash; r2 arg1 &ndash; r4 arg2 &ndash; r5 arg3 &ndash; r6 arg4 &ndash; r7</p>
<p>The result of the system call, if any, must be put back into r2.</p>
<p>And don't forget to increment the pc before returning. (Or else you'll loop making the same system call forever!</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">which</td><td>is the kind of exception. The list of possible exceptions are in <a class="el" href="machine_8h.html" title="Data structures for simulating the execution of user programs running on top of Nachos. ">machine.h</a>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
